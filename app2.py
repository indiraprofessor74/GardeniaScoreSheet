import streamlit as st
import pandas as pd
import gspread
import os
import time
from datetime import datetime
import base64
from io import BytesIO

# --- ðŸŽ¯ CONFIGURATION VARIABLES (MATCH YOUR SETUP) ---
SPREADSHEET_ID = "1wF-rfK371FomWMtRCGEiy5c-1RZztHatsIDvNB8pQuM" 
SCORE_SHEET_NAME = "scores" 
JUDGE_SHEET_NAME = "Judges_Metadata"
EVENT_SHEET_NAME = "Events_Metadata"
PARTICIPANT_SHEET_NAME = "Participants_Metadata"

# --- ADMIN CREDENTIALS ---
ADMIN_USERNAME = "admin"
ADMIN_PASSWORD = "Gcu@2025"

# --- SCORING CONFIGURATION ---
MAX_SCORE = 25.0
SCORE_STEP = 1.0

# NOTE: INSERT YOUR GENERATED BASE64 STRINGS HERE (from Step 1)
HEADING_B64 = "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" 
UNIVERSITY_HEADING_B64 = "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"
FAVICON_B64 = "iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAeUExURVQGBf////aEGXgtHPv6+trLyPGAGPLv7r9bFaSDgPGqkZoAAAO8SURBVFjD7ZjNa9swGIcDJl18NFUJuSogcnRr1jZHQaDXhFLGbkUDnxe2UnYbLowea7Yy+t9O74cbSbYTeYwdxoRLUsU/P3o/9EryKBvcRtlqUNMgGdi0GImbQW1rKWI0qG20leR/QzL99ylFsSyKAZTl8zubGJm4e8njKMmzFiAA1dX3GMpykwmbfVal9SrL3h+mLLfZChigsR+r7MshSqqF5vtFBkMLNG1KuqWH2wu+aA2a672Uzcreizc3IquZPu2hXOyGRF7DS8/6KSneSBcNC+0Ret1LqdlXKAI7MKC246SPkgr2EtwrkEjDczABpdbZqyHIg3pCopNuSooPBhlEXdx/Zi+j49adlFo3FJ3dvRR5UTxvgAhCMeuiJNusMWDaJGPyE62C2OQdlHFjunBCl/wQ6BN93UWpyVabY26CJBs0btblsUQ3AfRTNxXWkh3XpYw5S1bhbKg9rks5bWL4KZhyaW+ObdAOa3trYtdul0NJBFkijlvFI113z5cx5ZfWT9F17ELQenMVXy1rSi8xi6+WFDGdreMpWwrkIVMcCjhMdLq4l5JSLXJm7EHKmGf8LH59GXMJOo6nvCGI+BhPOeUit46nnML2xF7reErNqf8UT3nLWxRHkhRBCyhnJTbjRHIig5b7lMrtZonqkzDFYK+JkkxZgk1+HUJRShplPImnMaZNsQoZUJTT2hSJFBlQjMFe/AhtOQK07b/1KdQJX+zAA8qRIsq8n6KC6E9IYeaBLa8i+08Q/Qn/sAg8Zp3ConIRzn0ar1R5O2HoaXIRVhhD/W5gOBvzCjFqHtYx7pe37Xw/Ix/PQwr3u8bsJJgYtyHlXLI325LKTQyHwl72sowb+czkrfWFXSZbI+NfVHsVqwwmszfLHH5jpLtW2klm4HFuArQd5lEmitJMBZjEuA7z131OW2l8a87JLzLv2F1U9Dh7x4MLkejiUnXtlI44l2zbaZKKe+edOyXZUHaaxBYrvyj4+zF2DaS7XDxARj5i7mNY8s5dHwdAYb7bP8O5D73znr1lRcEkFVnFnt+VkWAH20xdGBtGFb87oe/YJ1cljAkeTLNeMcWZReFufCKpzCIAS5JB69SePf8ZmOFTgoLYOlkk6DEygxIOYrLYe36ZyBJLF5c1siXff0qaSJ9iSi/lOs9il1KVrxRl4/nh8Inv0g6nJIpFBIq+c+U3iB8sttZ7D5Gn1+KxxPQqHyNPr1xdLwedkf+/Vfjjr27yZBR/oeR+UMt+42VXpodJ8F3ACD6iG+6/fwEHd69XMJ/97QAAAABJRU5ErkJggg==" 

# --- End Configuration ---
# --- End Configuration ---


# --- Helper for PDF/HTML Download ---

# Inject favicon using unsafe markdown as a workaround for older Streamlit versions
if FAVICON_B64:
    FAVICON_HTML = f'<link rel="shortcut icon" href="data:image/png;base64,{FAVICON_B64}" type="image/x-icon">'
    st.markdown(FAVICON_HTML, unsafe_allow_html=True) 

def create_html_report(df):
    """Generates an A4-sized HTML report with custom headers and styled table, using embedded Base64 images."""
    if df.empty:
        return "<html><body><h1>No data to report.</h1></body></html>"

    university_heading_b64 = UNIVERSITY_HEADING_B64
    heading_b64 = HEADING_B64
    
    # Select the relevant columns for the final report presentation, including new metadata and the display name
    report_cols = [
        "Rank", 
        "Event Name", 
        "Participant Display Name", # NEW: Use the combined name
        "Registration ID",          # NEW
        "Participant Name",         # Leader Name
        "Team Member Names",        # NEW
        "Final Total Score",
        "Email Id", 
        "Mobile No", 
        "Organization Name"
    ]
    
    # Filter columns to only those present in the DataFrame
    df_report = df[[col for col in report_cols if col in df.columns]]
    
    # Optional: Rename 'Participant Display Name' to a cleaner 'Participant/Team' for the report
    if 'Participant Display Name' in df_report.columns:
        df_report = df_report.rename(columns={'Participant Display Name': 'Participant / Team'})

    # Convert DataFrame to an HTML table with simple styling
    html_table = df_report.to_html(index=False, classes='table table-striped', escape=False)

    # Full HTML structure with custom CSS for styling and A4 print format
    html_content = f"""
    <html>
    <head>
    <title>Gardenia - Winners List</title>
    <style>
        @page {{ size: A4; margin: 20mm; }}
        body {{ font-family: Arial, sans-serif; margin: 0; padding: 0; }}
        .container {{ width: 100%; max-width: 210mm; margin: 0 auto; padding: 20px; }}
        /* CSS for embedded images */
        .header-image {{ width: 100%; max-width: 400px; display: block; margin: 0 auto 10px; }} 
        .header h1 {{ margin-bottom: 5px; color: #004d99; font-size: 24pt; }}
        .header h2 {{ margin-top: 0; color: #555; font-size: 16pt; font-weight: normal; }}
        .table-container {{ margin-top: 30px; }}
        table {{ width: 100%; border-collapse: collapse; font-size: 10pt; }}
        th, td {{ border: 1px solid #ccc; padding: 8px 12px; text-align: left; }}
        th {{ background-color: #f2f2f2; font-weight: bold; color: #333; }}
    </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                {f'<img class="header-image" src="data:image/png;base64,{university_heading_b64}" alt="University Heading">' if university_heading_b64 else '<h1>[University Heading Placeholder]</h1>'}
                {f'<img class="header-image" src="data:image/png;base64,{heading_b64}" alt="Event Heading">' if heading_b64 else '<h2>[Event Heading Placeholder]</h2>'}
                <h2>Gardenia - 2025 Winners List</h2>
                <p>Generated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}</p>
            </div>
            <div class="table-container">
                {html_table}
            </div>
        </div>
    </body>
    </html>
    """
    return html_content

def get_html_download_link(html_content, filename):
    """Creates a download button for the generated HTML content."""
    b64 = base64.b64encode(html_content.encode()).decode()
    return f"""
        <a href="data:text/html;base64,{b64}" download="{filename}" target="_blank">
            <button style="
                background-color: #4CAF50; 
                color: white; 
                padding: 10px 20px; 
                border: none; 
                border-radius: 4px; 
                cursor: pointer; 
                font-size: 16px;">
                â¬‡ï¸ Download Report (PDF Ready)
            </button>
        </a>
    """

# ----------------------------------------------------------------------------------------------------
## Utility Functions (Google Sheets Connection - USING ST.SECRETS)
# ----------------------------------------------------------------------------------------------------

@st.cache_resource
def get_google_sheet_client():
    """Initializes and returns the gspread client using Streamlit Secrets."""
    try:
        # Load credentials from Streamlit Secrets (reads from the [gcp_service_account] section)
        creds_dict = st.secrets["gcp_service_account"].to_dict()
        
        # Authenticate gspread using the dictionary
        gc = gspread.service_account_from_dict(creds_dict)
        
        return gc.open_by_key(SPREADSHEET_ID)
    except KeyError:
        st.error("âŒ 'gcp_service_account' section missing from Streamlit Secrets. Cannot connect. Check your secrets file.")
        st.stop()
    except Exception as e:
        st.error(f"âŒ Failed to connect to Google Sheet. Error: {e}")
        st.stop()

spreadsheet = get_google_sheet_client()

@st.cache_data(ttl=300) 
def load_sheet_data(sheet_name):
    """Reads a specific sheet and returns it as a DataFrame."""
    try:
        worksheet = spreadsheet.worksheet(sheet_name)
        data = worksheet.get_all_records()
        df = pd.DataFrame(data)
        
        # FIX: Strip whitespace from all column names immediately after loading
        df.columns = df.columns.str.strip()

        # NOTE: 'Event_ID' column does not exist in Participants_Metadata based on user input,
        # so this specific numeric conversion for Participants will now be skipped,
        # but kept for other sheets that might use it (like Judges).
        if sheet_name in [JUDGE_SHEET_NAME] and 'Event_ID' in df.columns:
            df['Event_ID'] = pd.to_numeric(df['Event_ID'], errors='coerce').fillna(0).astype(int)
        
        # FIX: Ensure E_ID in Events is treated as integer
        if sheet_name == EVENT_SHEET_NAME and 'E_ID' in df.columns:
            df['E_ID'] = pd.to_numeric(df['E_ID'], errors='coerce').fillna(0).astype(int)
        
        return df
    except gspread.WorksheetNotFound:
        st.error(f"âŒ Required metadata sheet '{sheet_name}' not found. Check sheet names.")
        st.stop()
    except Exception as e:
        # This will catch gspread errors like duplicate column names
        st.error(f"âŒ Error loading metadata from sheet '{sheet_name}'. Error: {e}")
        return pd.DataFrame()

def write_score_to_sheet(score_data):
    """Appends a new row of score data to the main Score Sheet."""
    # Expected score_data format (14 elements): 
    # [Judge Name, Event Name, Date, Leader Name, Round, C1, C2, C3, C4, C5, Total, Team Member Names, Team Member College/School Names, Date & Time Entered]
    try:
        worksheet = spreadsheet.worksheet(SCORE_SHEET_NAME)
        worksheet.append_row(score_data, value_input_option='USER_ENTERED')
        return True
    except Exception as e:
        st.error(f"âŒ Google Sheet write failed: {e}")
        return False

# ----------------------------------------------------------------------------------------------------
## Score Submission Form (Reusable Function for New Entry and Modify)
# ----------------------------------------------------------------------------------------------------

# Function signature MUST now include 'participant_data' (DF), and 'selected_round' (for modify)
def score_submission_form(judge_name, event_name, event_date, c_names, participant_data, is_new, selected_participant_name=None, initial_scores=[0.0, 0.0, 0.0, 0.0, 0.0], selected_round=None):
    """Renders the score submission form, pre-filled if modifying an old score."""
    
    max_score = MAX_SCORE
    step = SCORE_STEP
    
    # --- FIND CORRECT LEADER NAME COLUMN ---
    leader_name_col = None
    possible_leader_cols = ['Leader Name', 'Participant Name', 'P_Name', 'Name']
    
    for col in possible_leader_cols:
        if col in participant_data.columns:
            leader_name_col = col
            break

    if not leader_name_col:
        st.error("âŒ Critical: Could not find 'Leader Name' or 'Participant Name' column in participant data.")
        return
        
    # Alias the found column to 'P_Name' for internal logic
    temp_df = participant_data.rename(columns={leader_name_col: 'P_Name'})
    participant_names = temp_df['P_Name'].tolist() 
    # ---------------------------------------

    # Create Round list (assuming max 4 rounds, adjust as needed)
    round_list = [str(i) for i in range(1, 5)] 
    
    current_round = None

    if is_new:
        selected_participant_name = st.selectbox(
            "Select Participant (Leader Name) to Score", 
            [""] + participant_names, 
            key='new_participant_select'
        )
        # In new entry, default to Round 1
        current_round = st.selectbox("Select Round", round_list, key='new_round_select')
        
    else:
        # In modify tab, participant and round are selected/displayed externally
        st.markdown(f"**Modifying Score for:** **{selected_participant_name}**")
        # Ensure the selected_round is in the list and set the initial index
        round_index = round_list.index(str(selected_round)) if str(selected_round) in round_list else 0
        current_round = st.selectbox("Select Round", round_list, index=round_index, key='modify_round_select')

    
    if not selected_participant_name:
        return
        
    # NEW: Find the display name and team info for the currently selected participant/leader
    try:
        # Use the found column name for filtering
        participant_row = participant_data[participant_data[leader_name_col] == selected_participant_name].iloc[0]
        is_group = participant_row.get('Event Type') == 'Group'
        
        team_members = participant_row.get('Team Member Names', '')
        team_college = participant_row.get('Team Member College/School Names', '')

        # Display the combined name if it's a group
        display_name = f"{selected_participant_name} ({team_members})" if is_group and team_members else selected_participant_name
    except Exception:
        display_name = selected_participant_name # Fallback 
        team_members = ''
        team_college = ''
        
    st.markdown(f"**Participant:** `{display_name}`")
    st.markdown(f"**Round:** `{current_round}`")
        
    # KEY now includes participant name and round for uniqueness
    form_key = f"score_form_{'new' if is_new else 'modify'}_{selected_participant_name}_{current_round}" 
    
    with st.form(form_key, clear_on_submit=is_new):
        st.markdown(f"**Adjust Marks (Max {max_score:.0f} per criterion):**")
        
        # --- SLIDER INPUTS ---
        cols_slider = st.columns([1, 4])
        
        with cols_slider[0]:
            st.markdown(f"**{c_names['c1']}:**")
            st.markdown(f"**{c_names['c2']}:**")
            st.markdown(f"**{c_names['c3']}:**")
            st.markdown(f"**{c_names['c4']}:**")
            st.markdown(f"**{c_names['c5']}:**") # NEW CRITERION 5
            
        with cols_slider[1]:
            # Ensure values are float for sliders
            c1 = st.slider("c1", min_value=0.0, max_value=max_score, value=float(initial_scores[0]), step=step, key=f'{form_key}_c1_val', label_visibility="collapsed")
            c2 = st.slider("c2", min_value=0.0, max_value=max_score, value=float(initial_scores[1]), step=step, key=f'{form_key}_c2_val', label_visibility="collapsed")
            c3 = st.slider("c3", min_value=0.0, max_value=max_score, value=float(initial_scores[2]), step=step, key=f'{form_key}_c3_val', label_visibility="collapsed")
            c4 = st.slider("c4", min_value=0.0, max_value=max_score, value=float(initial_scores[3]), step=step, key=f'{form_key}_c4_val', label_visibility="collapsed")
            c5 = st.slider("c5", min_value=0.0, max_value=max_score, value=float(initial_scores[4]), step=step, key=f'{form_key}_c5_val', label_visibility="collapsed") # NEW CRITERION 5

        total = c1 + c2 + c3 + c4 + c5 # UPDATE TOTAL CALCULATION
        st.success(f"**Automatic Total: {total:.1f}**")
        
        submit_label = "Submit New Score ðŸ’¾" if is_new else "Overwrite/Update Score ðŸ“"

        if st.form_submit_button(submit_label):
            submission_timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

            # --- UPDATED score_data ARRAY (14 elements) ---
            score_data = [
                judge_name, 
                event_name, 
                event_date, 
                selected_participant_name, # This maps to 'Leader Name' in the score sheet
                current_round, 
                c1, c2, c3, c4, c5, 
                total,
                team_members,      # Mapped from metadata sheet
                team_college,      # Mapped from metadata sheet
                submission_timestamp # Date & Time Entered
            ]
            
            if write_score_to_sheet(score_data):
                action = "New Score" if is_new else "Score Update"
                st.success(f"âœ… {action} for **{selected_participant_name}** (Round {current_round}, {total:.1f}) recorded in Google Sheet! (Old score is overwritten by averaging.)")
                load_sheet_data.clear() # Clear cache to refresh results/modify list
                st.rerun()

# ----------------------------------------------------------------------------------------------------
## Session State and Login
# ----------------------------------------------------------------------------------------------------

for k, v in {"logged_in": False, "username": None, "assigned_event_id": None, "assigned_event_name": None, "role": None}.items():
    st.session_state.setdefault(k, v)

def login_user_gsheet():
    """Authenticates user against Admin fixed credentials or Judge metadata sheet."""
    st.title("ðŸŽ¤ Gardenia25-Scoring System")
    
    # Display the image using Base64/Markdown
    if UNIVERSITY_HEADING_B64:
        st.markdown(f'<img src="data:image/png;base64,{UNIVERSITY_HEADING_B64}" width="200">', unsafe_allow_html=True)
    else:
        st.warning("University heading image not loaded (Placeholder Active).")
        
    st.subheader("ðŸ” User Login")
    st.info("Please enter your designated username and password to proceed.")
    
    judges_df = load_sheet_data(JUDGE_SHEET_NAME)
    events_df = load_sheet_data(EVENT_SHEET_NAME)
    
    username_in = st.text_input("Username", key="login_username")
    pwd_in = st.text_input("Password", type="password", key="login_password")
    
    if st.button("Login"):
        
        # --- 1. ADMIN LOGIN CHECK ---
        if username_in == ADMIN_USERNAME and pwd_in == ADMIN_PASSWORD:
            st.session_state.update({
                "logged_in": True,
                "username": "Score Committee Admin",
                "role": "Admin"
            })
            st.success("Admin Login Successful! Accessing Results Panel.")
            time.sleep(1)
            st.rerun()
            return

        # --- 2. JUDGE LOGIN CHECK (DYNAMIC) ---
        
        judge_row = judges_df[
            (judges_df['Username'] == username_in) & 
            (judges_df['Password'] == pwd_in)
        ]
        
        if not judge_row.empty:
            judge_name = judge_row['J_Name'].iloc[0]
            assigned_event_id = judge_row['Assigned_E_ID'].iloc[0]
            
            event_row = events_df[events_df['E_ID'] == assigned_event_id]
            
            if not event_row.empty:
                assigned_event_name = event_row['E_Name'].iloc[0]
                
                # Update session state with the correct assigned event info
                st.session_state.update({
                    "logged_in": True,
                    "username": judge_name,
                    "assigned_event_id": assigned_event_id,
                    "assigned_event_name": assigned_event_name,
                    "role": "Judge" 
                })
                st.success(f"Login Successful! Judge {judge_name} assigned to {assigned_event_name}.")
                time.sleep(1)
                st.rerun()
            else:
                 st.error("âŒ Login failed: Assigned event not found in metadata sheet.")
        else:
            st.error("âŒ Invalid username or password. Please try again.")

# ----------------------------------------------------------------------------------------------------
## UI Interface 1: Judge Score Submission (Write Data)
# ----------------------------------------------------------------------------------------------------

def judge_score_page():
    """The main score entry and modification UI for a judge."""
    
    # Display the image using Base64/Markdown
    if HEADING_B64:
        st.markdown(f'<img src="data:image/png;base64,{HEADING_B64}" class="img-fluid" style="width: 100%;">', unsafe_allow_html=True)
    else:
        st.warning("Event heading image not loaded (Placeholder Active).")
        
    st.markdown("## ðŸ“ Judge Score Management")
    
    judge_name = st.session_state.username
    e_id = st.session_state.assigned_event_id
    event_name = st.session_state.assigned_event_name # This is the Event Title string
    
    # Load metadata (needed for criteria and participant list)
    events_df = load_sheet_data(EVENT_SHEET_NAME)
    participants_df = load_sheet_data(PARTICIPANT_SHEET_NAME)
    
    event_row = events_df[events_df['E_ID'] == e_id]
    
    if event_row.empty:
        st.error("Error: Could not find event details in metadata.")
        return

    # Extract required info
    event_row = event_row.iloc[0]
    event_date = str(event_row['Datetime']).split(' ')[0] 
    
    # Extract criteria names for dynamic labels
    c_names = {
        'c1': event_row.get('Criterion1_Name', 'Criterion 1: Default'),
        'c2': event_row.get('Criterion2_Name', 'Criterion 2: Default'),
        'c3': event_row.get('Criterion3_Name', 'Criterion 3: Default'),
        'c4': event_row.get('Criterion4_Name', 'Criterion 4: Default'),
        'c5': event_row.get('Criterion5_Name', 'Criterion 5: Default'), # NEW CRITERION 5
    }

    st.markdown(f"**Judge:** `{judge_name}` | **Event:** `{event_name}` | **Date:** `{event_date}`")

    # FIX: Participant filtering is now done using 'Event Title' column and the 'event_name' string.
    if 'Event Title' not in participants_df.columns:
        st.error("âŒ 'Event Title' column not found in Participants Metadata. Please ensure the column names are exactly as specified.")
        return
        
    event_participants_df = participants_df[
        participants_df['Event Title'] == event_name
    ].copy()

    if event_participants_df.empty:
        st.warning(f"No participants found for event '{event_name}' in the metadata sheet (filtered by 'Event Title').")
        return
        
    # --- FIND CORRECT LEADER NAME COLUMN ---
    leader_name_col = None
    possible_leader_cols = ['Leader Name', 'Participant Name', 'P_Name', 'Name', 'LEADER NAME']
    
    for col in possible_leader_cols:
        if col in event_participants_df.columns:
            leader_name_col = col
            break

    if not leader_name_col:
        st.error(f"âŒ Critical: Could not find Leader/Participant Name column in data. Available columns are: **{list(event_participants_df.columns)}**")
        return
        
    # Alias the found column to 'P_Name' for internal use in the score submission form
    event_participants_df = event_participants_df.rename(columns={leader_name_col: 'P_Name'})
    # ---------------------------------------
        
    # --- TAB SETUP ---
    tab_new, tab_modify = st.tabs(["ðŸ†• New Score Entry", "âœï¸ Review & Modify Marks"])

    with tab_new:
        st.markdown("### Entering New Scores")
        # --- NEW SCORE ENTRY LOGIC ---
        # Pass the DataFrame of event participants (Leader Names)
        score_submission_form(judge_name, event_name, event_date, c_names, event_participants_df, is_new=True)

    with tab_modify:
        st.markdown("### View Your Submitted Scores")
        
        # Load all scores and filter by judge and event
        all_scores_df = load_sheet_data(SCORE_SHEET_NAME)
        
        if all_scores_df.empty:
            st.info("No scores found in the sheet yet.")
            return

        # NEW: Aggregation key is now 'Leader Name'
        judge_scores_df = all_scores_df[
            (all_scores_df['Judge Name'] == judge_name) & 
            (all_scores_df['Event Name'] == event_name)
        ].copy() # Use .copy() to avoid SettingWithCopyWarning
        
        # Ensure 'Round' is available for the check (default to '1' for old entries)
        if 'Round' not in judge_scores_df.columns:
            judge_scores_df['Round'] = '1'
        else:
            judge_scores_df['Round'] = judge_scores_df['Round'].astype(str)

        if judge_scores_df.empty:
            st.info(f"You have not submitted any scores for the event: {event_name}.")
            return
            
        # Get the latest score for each participant/round combination by this judge
        # Key must use 'Leader Name'
        latest_scores_df = judge_scores_df.sort_values(by='Date & Time Entered', ascending=False).drop_duplicates(subset=['Leader Name', 'Round'])
        
        st.dataframe(latest_scores_df[[
            'Date & Time Entered', 'Leader Name', 'Round', # KEY: Leader Name
            'Criterion1_Marks', 'Criterion2_Marks', 'Criterion3_Marks', 'Criterion4_Marks', 'Criterion5_Marks', 'Total' # ADD C5 TO DISPLAY
        ]], use_container_width=True, hide_index=True)

        st.divider()
        st.markdown("### Modify a Previous Score")
        
        # Dropdown to select participant AND round whose score needs modifying
        # Create a combined identifier for selection (Leader Name - Round X)
        latest_scores_df['Selection_ID'] = latest_scores_df['Leader Name'] + " - Round " + latest_scores_df['Round'].astype(str) # KEY: Leader Name

        modify_selection_ids = latest_scores_df['Selection_ID'].tolist()
        
        selected_id_modify = st.selectbox(
            "Select Participant and Round to Modify", 
            [""] + modify_selection_ids, 
            key='modify_id_select'
        )

        if selected_id_modify:
            # Find the row for the selected participant/round combination
            past_row = latest_scores_df[latest_scores_df['Selection_ID'] == selected_id_modify].iloc[0]
            
            # Extract name and round from the selected row
            p_name = past_row['Leader Name'] # KEY: Leader Name
            p_round = str(past_row['Round']) 
            
            # Use the score submission form, pre-filled with the existing scores
            score_submission_form(
                judge_name, 
                event_name, 
                event_date, 
                c_names, 
                event_participants_df, # Pass DataFrame
                is_new=False,
                selected_participant_name=p_name,
                selected_round=p_round, # Pass selected round
                initial_scores=[
                    past_row['Criterion1_Marks'], 
                    past_row['Criterion2_Marks'], 
                    past_row['Criterion3_Marks'], 
                    past_row['Criterion4_Marks'],
                    past_row.get('Criterion5_Marks', 0.0) # SAFELY GET C5, default to 0.0
                ]
            )

# ----------------------------------------------------------------------------------------------------
## UI Interface 2: Results (Readonly)
# ----------------------------------------------------------------------------------------------------

@st.cache_data(ttl=60)
def read_and_process_scores():
    """
    Reads scores and participant metadata, merges them, and calculates aggregates.
    
    Returns: (final_detailed_df, raw_scores_df) or None if no scores found.
    """
    results_df = load_sheet_data(SCORE_SHEET_NAME) # This is the raw scores DataFrame
    participants_df = load_sheet_data(PARTICIPANT_SHEET_NAME)
    
    if results_df.empty:
        return None, pd.DataFrame()
    
    # 1. Clean and Prepare Scores Data
    score_cols = ['Criterion1_Marks', 'Criterion2_Marks', 'Criterion3_Marks', 'Criterion4_Marks', 'Criterion5_Marks', 'Total']
    for col in score_cols:
        if col in results_df.columns:
             results_df[col] = pd.to_numeric(results_df[col], errors='coerce').fillna(0)
             
    # Ensure 'Round' is present
    if 'Round' not in results_df.columns:
        results_df['Round'] = '1'
        
    # Ensure 'Leader Name' is present as the key from the score sheet
    if 'Leader Name' not in results_df.columns:
        st.error("âŒ Aggregation failed: 'Leader Name' column not found in scores sheet.")
        return None, results_df

    # --- RAW SCORE PROCESSING (For detailed display) ---
    
    # Create a unique key for each raw score submission
    results_df['Raw_Score_ID'] = results_df['Judge Name'].str.cat(results_df['Round'].astype(str), sep='_R')
    
    # Select key columns for pivoting/detailed view
    raw_scores_wide = results_df.sort_values(by='Date & Time Entered', ascending=False).drop_duplicates(
        subset=['Judge Name', 'Leader Name', 'Round']
    ).copy()
    
    # Pivot the data to get Judge/Round scores as separate columns
    raw_scores_pivot = raw_scores_wide.pivot_table(
        index=['Event Name', 'Leader Name'], 
        columns='Raw_Score_ID', 
        values='Total',
        aggfunc='first' # Use the latest total score for that judge/round combo
    ).reset_index()
    
    # Flatten the column names (pivot adds multi-index, we need simple names)
    raw_scores_pivot.columns = [
        col if isinstance(col, str) else f"Judge_Round_{col}" 
        for col in raw_scores_pivot.columns
    ]
    
    # --- FINAL AGGREGATED SCORE CALCULATION (For ranking) ---

    # STEP 1: Average Judge Scores per Leader per Round
    avg_scores_per_round = results_df.groupby(["Event Name", "Leader Name", "Round"]).agg(
        Total_Round_Avg=('Total', 'mean'), 
        Judges_Count=('Judge Name', 'nunique')
    ).reset_index()

    # STEP 2: Sum Round Averages for Final Total Score
    final_aggregated = avg_scores_per_round.groupby(["Event Name", "Leader Name"]).agg(
        Final_Total=('Total_Round_Avg', 'sum'), 
        Rounds_Count=('Round', 'nunique'),
        Judges_Count_Max=('Judges_Count', 'max') 
    ).reset_index()
    
    # 2. Merge Final Aggregated Scores with Raw Wide Scores
    final_merged_df = pd.merge(
        final_aggregated,
        raw_scores_pivot,
        on=['Event Name', 'Leader Name'],
        how='left'
    )

    # 3. Merge with Participant Metadata 
    
    # --- FIND CORRECT LEADER NAME COLUMN FOR MERGE ---
    leader_name_col_merge = None
    possible_leader_cols_merge = ['Leader Name', 'Participant Name', 'P_Name', 'Name', 'LEADER NAME']
    
    for col in possible_leader_cols_merge:
        if col in participants_df.columns:
            leader_name_col_merge = col
            break
            
    if not leader_name_col_merge:
        st.error("âŒ Critical: Could not find a suitable column for Leader/Participant Name in metadata for results merge.")
        return final_merged_df.rename(columns={'Leader Name': 'Participant Name'}), results_df
    
    # Define mapping columns
    column_mapping = {
        leader_name_col_merge: 'Leader Name', # MAP: Found column name becomes 'Leader Name' for the merge key
        'Registration ID': 'Registration ID',
        'Team Member Names': 'Team Member Names',
        'Team Member College/School Names': 'Team Member College/School Names', 
        'Leader College/School Name': 'Organization Name',
        'Leader Email': 'Email Id',
        'Leader Phone': 'Mobile No',
        'Event Type': 'Participant Type' 
    }
    
    # Filter mapping to only include columns that exist in the metadata DF
    valid_mapping = {k: v for k, v in column_mapping.items() if k in participants_df.columns}
    
    participant_details = participants_df.rename(columns=valid_mapping)

    # Select required columns from participant data (use the mapped names)
    required_mapped_cols = [
        'Leader Name', 'Registration ID', 'Team Member Names', 
        'Team Member College/School Names', 
        'Participant Type', 'Email Id', 'Mobile No', 'Organization Name'
    ]
    participant_details = participant_details[[col for col in required_mapped_cols if col in participant_details.columns]].drop_duplicates(subset=['Leader Name'])
    
    # Perform Merge on 'Leader Name'
    final_df = pd.merge(
        final_merged_df,
        participant_details,
        on='Leader Name',
        how='left'
    ).drop_duplicates(subset=['Event Name', 'Leader Name']) 

    # 4. Final Column Renaming and Cleanup
    
    # Rename 'Leader Name' to 'Participant Name' for UI consistency
    final_df = final_df.rename(columns={'Leader Name': 'Participant Name'})
    
    # Rename aggregated columns for display
    final_df = final_df.rename(columns={
        "Final_Total": "Grand Total", # New name for the final score
        "Rounds_Count": "Rounds Count", 
        "Judges_Count_Max": "Judges Count",
    })
    
    # NEW: Create a combined display name for the judge form/report
    final_df['Participant Display Name'] = final_df.apply(
        lambda row: f"{row['Participant Name']} ({row['Team Member Names']})" 
                    if row.get('Participant Type') == 'Group' and pd.notna(row.get('Team Member Names')) 
                    else row['Participant Name'], 
        axis=1
    )
    
    return final_df, results_df 

def results_page():
    """Interface 2: Results (Readonly) - Reads from Google Sheet"""
    
    if HEADING_B64:
        st.markdown(f'<img src="data:image/png;base64,{HEADING_B64}" class="img-fluid" style="width: 100%;">', unsafe_allow_html=True)
    else:
        st.warning("Event heading image not loaded (Placeholder Active).")
        
    st.markdown("## ðŸ“Š Event Results (Readonly)")

    processed_tuple = read_and_process_scores()
    
    if processed_tuple is None or processed_tuple[0].empty:
        st.info("No scores found in the Google Sheet.")
        return
        
    aggregated_results, raw_scores_df = processed_tuple 
    
    # --- Filters Setup ---
    event_names = ["All Events"] + aggregated_results["Event Name"].unique().tolist()
    
    col_event, col_option = st.columns([1.5, 1])
    
    with col_event:
        selected_event = st.selectbox("Filter by Event", event_names)
        
    with col_option:
        # User selected filters: Winners/All
        max_all_option = st.radio("Display Option", ["Winners", "All"], horizontal=True)

    st.divider()

    # Apply Event filter
    filtered_agg_df = aggregated_results.copy()
    if selected_event != "All Events":
        filtered_agg_df = filtered_agg_df[filtered_agg_df["Event Name"] == selected_event]
        
    # Apply filter logic
    if max_all_option == "Winners":
        if not filtered_agg_df.empty:
            
            if selected_event == "All Events":
                # Find the top 2 for *each* event across all events
                def get_top_two(df):
                    # Sort by the final ranking score: "Grand Total"
                    return df.sort_values(by="Grand Total", ascending=False).head(2)
                
                final_display_df = filtered_agg_df.groupby('Event Name', group_keys=False).apply(get_top_two).reset_index(drop=True)
            else:
                # Find the top 2 for the selected event
                final_display_df = filtered_agg_df.sort_values(by="Grand Total", ascending=False).head(2).reset_index(drop=True)

            # Add Rank column for Winners list
            final_display_df['Rank'] = final_display_df.groupby('Event Name')['Grand Total'].rank(ascending=False, method='min').astype(int)
            final_display_df = final_display_df.sort_values(by=["Event Name", "Rank"])
        else:
            final_display_df = filtered_agg_df
            
    else: # "All" is selected - REQUIRED: Sort by Total Score (Descending)
        final_display_df = filtered_agg_df.sort_values(
            by=["Event Name", "Grand Total"], 
            ascending=[True, False] 
        )
        final_display_df['Rank'] = final_display_df.groupby('Event Name')['Grand Total'].rank(ascending=False, method='min').astype(int)


    # 3. Display Results - Build the column order
    
    # Dynamic columns from the pivot table (Judge_Round_Total)
    judge_round_cols = [col for col in final_display_df.columns if col.startswith('Judge_Round_')]
    
    # Base columns for metadata and ranking
    base_cols = [
        "Rank", "Event Name", "Participant Display Name", "Grand Total", 
        "Judges Count", "Rounds Count", "Registration ID", 
        "Organization Name", "Email Id", "Mobile No",
        "Team Member Names", "Team Member College/School Names" 
    ]
    
    # Combine columns: Metadata/Ranking + Judge Details
    ordered_cols = [col for col in base_cols if col in final_display_df.columns]
    
    # Insert Judge/Round scores after the Grand Total
    grand_total_index = ordered_cols.index("Grand Total") + 1 if "Grand Total" in ordered_cols else len(ordered_cols)
    for col in sorted(judge_round_cols): # Sort dynamically generated columns
        ordered_cols.insert(grand_total_index, col)
        grand_total_index += 1
    
    # Filter final_display_df to show only the required columns, maintaining order
    display_df = final_display_df[[col for col in ordered_cols if col in final_display_df.columns]].copy()
    
    # Conditional display logic for Team Members columns (show only if Participant Type is 'Group')
    if 'Participant Type' in final_display_df.columns:
        # Create a boolean mask for rows where the participant type is NOT 'Group'
        mask_individual = final_display_df['Participant Type'] != 'Group'
        
        # Apply the mask to blank out the Team columns for individual participants
        if 'Team Member Names' in display_df.columns:
            display_df.loc[mask_individual, 'Team Member Names'] = ''
        if 'Team Member College/School Names' in display_df.columns:
            display_df.loc[mask_individual, 'Team Member College/School Names'] = ''

    # Optional: Rename 'Participant Display Name' for table display
    if 'Participant Display Name' in display_df.columns:
        display_df = display_df.rename(columns={'Participant Display Name': 'Participant / Team'})
    
    # Rename dynamic columns for cleaner display (e.g., "Judge_Round_radhika malhotra_R1" -> "radhika_R1 Score")
    rename_map = {col: col.replace('Judge_Round_', '').replace('_R', ' R') + ' Score' for col in judge_round_cols}
    display_df = display_df.rename(columns=rename_map)


    
    st.markdown("### Processed Results (Sum of Averaged Round Scores)")
    st.dataframe(display_df, use_container_width=True, hide_index=True)
    
    # --- Action Buttons (Download/Email) ---
    st.markdown("---")
    st.subheader("Results Distribution")
    
    # Prepare data for export
    printable_data = create_html_report(display_df)

    # 1. Download Button (Generates HTML for PDF printing)
    col_download, col_email_input, col_email_button = st.columns([1, 2, 1])

    with col_download:
        filename = f"Gardenia_Winners_Report_{selected_event}_{datetime.now().strftime('%Y%m%d')}.html"
        html_link = get_html_download_link(printable_data, filename)
        st.markdown(html_link, unsafe_allow_html=True)
        st.caption("Open file in browser, then Print (Ctrl+P) and save as PDF.")

    # 2. Email Simulation
    with col_email_input:
        recipient_email = st.text_input("Enter Email ID to send results:", key="email_recipient")
    
    with col_email_button:
        st.markdown("<br>", unsafe_allow_html=True) 
        if st.button("ðŸ“§ Send Results via Email"):
            if "@" in recipient_email and "." in recipient_email:
                # --- EMAIL SIMULATION LOGIC ---
                st.success(f"ðŸ“§ [SIMULATED] Email request logged for {recipient_email}.")
                st.info("NOTE: For real email functionality, a backend service (like SendGrid) is required.")
                # --- END SIMULATION ---
            else:
                st.error("âŒ Please enter a valid email address.")


    with st.expander("View Raw Judge Scores from Google Sheet"):
        # Filter raw scores for the display too
        filtered_raw_df = raw_scores_df[raw_scores_df["Event Name"] == selected_event] if selected_event != "All Events" else raw_scores_df
        
        # Ensure 'Round' is visible in raw data
        if 'Round' in filtered_raw_df.columns:
             # Exclude Total for brevity, but include all new columns
             raw_display_cols = [col for col in filtered_raw_df.columns if col not in ['Total']]
             st.dataframe(filtered_raw_df[raw_display_cols], use_container_width=True, hide_index=True)
        else:
             st.dataframe(filtered_raw_df, use_container_width=True, hide_index=True)


# ----------------------------------------------------------------------------------------------------
## Main Application Flow (Role-Based Access Control)
# ----------------------------------------------------------------------------------------------------

st.set_page_config(
    "Gardenia 2024-Score Management System", 
    layout="wide"
)

if st.session_state.logged_in:
    if st.button("ðŸšª Logout"):
        load_sheet_data.clear() # Clear all caches on logout
        st.session_state.clear()
        st.rerun()
    
    st.sidebar.markdown(f"**Logged in as:** **{st.session_state.username}**")
    
    if st.session_state.role == "Admin":
        st.markdown(f"## Welcome, {st.session_state.username}!")
        results_page()
    
    elif st.session_state.role == "Judge":
        st.markdown(f"## Welcome, Judge {st.session_state.username}!")
        
        # Display ONLY the Judge Score Management tab
        tab1 = st.tabs(["ðŸ“ Judge Score Management"]) 
        
        with tab1[0]:
            judge_score_page()

else:
    login_user_gsheet()

# Disclaimer 
st.markdown("<hr><p style='text-align:center; font-size:12px; color:gray;'>"
             "All data, including login credentials and events, are managed by Central Scoring Committee."
             "</p>", unsafe_allow_html=True)

try:
    # Final check: This block executes after the entire app runs
    worksheet = spreadsheet.worksheet(SCORE_SHEET_NAME)
    # worksheet.get_all_records() # Removed to prevent unnecessary logging of large data
    print("Google Sheet connection object initialized successfully.")
except Exception as e:
    # Catch any error from the final connection check after deployment
    print(f"Final check error: {e}")
